<html>

<head>
    <title>Snarkjs client example</title>
</head>

<body>

    <h1>Snarkjs client example</h1>
    <button id="FoldOnce"> Click to bench a single fold proving time </button>

    <!-- JS-generated output will be added here. -->
    <pre class="witness"> Witness: <code id="witness"></code></pre>

    <!-- This is a modified SnarkJS version which doesn't create files on WitGen-->
    <script src="js/snarkjs.js" type="text/javascript">   </script>

    <!-- This is the bundle generated by rollup.js -->
    <script type="module">
        // Import the loadAndCallSingleFold function from fold.js
        import { loadAndCallSingleFold } from './js/fold.js';  // Adjust the path if needed

        const FoldOnce = document.getElementById("FoldOnce");

        bGenWitness.addEventListener("click", FoldOnce);

        async function FoldOnce() {
            const input = {
                // This should contain the previous IVC input 
                // obtained from the output of the previous fold.
                ivc_input: [3],
                // This are the values that are used as input on each round.
                // The inputs of the circuit logic that we want to prove within IVC.
                external_inputs: [6, 7],
            };

            // Compute witness with the custom `snarkjs.js` file
            // avoiding creating JSON objects.
            let z = await snarkjs.wtns.calculate(input, "with_external_inputs.wasm")
            console.log("witgen done!")

            // Path to the binary file relative to the root of your site
            const filePath = 'with_external_inputs.r1cs';

            // Fetch the r1cs file from the contents sent by the server.
            const r1cs_response = await fetch(filePath);
            const r1cs_bytes = await r1cs_response.arrayBuffer();
            const r1cs_res = new Uint8Array(r1cs_bytes);

            // Now we call Sonobe to start folding our z
            var res = await loadAndCallSingleFold(r1cs_res, z);
        }

    </script>

</body>

</html>
<html>

<head>
    <title>Snarkjs client example</title>
</head>

<body>

    <h1>Snarkjs client example</h1>
    <button id="bGenWitness"> Create Witness </button>

    <!-- JS-generated output will be added here. -->
    <pre class="witness"> Witness: <code id="witness"></code></pre>

    <!-- This is a modified SnarkJS version which doesn't create files on WitGen-->
    <script src="js/snarkjs.js" type="text/javascript">   </script>

    <!-- This is the bundle generated by rollup.js -->
    <script type="module">
        // Import the loadAndCallSingleFold function from fold.js
        import { loadAndCallSingleFold } from './js/fold.js';  // Adjust the path if needed

        const bGenWitness = document.getElementById("bGenWitness");

        bGenWitness.addEventListener("click", calculateWitness);

        async function calculateWitness() {
            const input = {
                ivc_input: [3],
                external_inputs: [6, 7],
            };
            let z = await snarkjs.wtns.calculate(input, "with_external_inputs.wasm")
            console.log("z computed!")

            // Path to the binary file relative to the root of your site
            const filePath = 'with_external_inputs.r1cs';

            // Fetch the r1cs file from the contents sent by the server.
            const r1cs_response = await fetch(filePath);
            const r1cs_bytes = await r1cs_response.arrayBuffer();
            const r1cs_res = new Uint8Array(r1cs_bytes);
            console.log("r1cs_res", r1cs_res);

            // Now we call Sonobe to start folding our z
            var res = await loadAndCallSingleFold(r1cs_res, z);
            alert(res);


        }

    </script>

</body>

</html>